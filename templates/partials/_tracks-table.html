{% load humanize %}
{% load taggit_templatetags2_tags %}

{% if tracks %}
    <table class="table table-hover table-condensed">
        <thead>
            <tr>
                <th>Name</th>
                <th>Started</th>
                <th>Length</th>
                <th class="center">Tags</th>
                <th class="center">Status</th>
                <th class="center">Edit</th>
            </tr>
        </thead>
        <tbody>
            {% for track in tracks %}
                <tr id="track{{ track.id }}">
                    <td>
                        <a href="{% url 'track:view' track.id %}">{{ track.name }}</a>
                    </td>
                    <td>{{ track.start_date|naturaltime }}</td>
                    <td>{{ track.length|floatformat }} km</td>
                    <td>
                        {% get_tags_for_object track as 'tags' %}
                        {% for tag in tags|slice:':3' %}
                            <a href="{% url 'tag:tag' tag.slug %}" class="label label-default">{{ tag }}</a>
                        {% endfor %}
                        {% if tags|length > 3 %}
                            <i class="label label-default">...</i>
                        {% endif %}
                    </td>
                    <td class="center status">
                        {% if track.public %}
                            <a href="#" class="glyphicon glyphicon-globe" title="public"></a>
                        {% else %}
                            <a href="#" class="glyphicon glyphicon-user" title="private"></a>
                        {% endif %}
                    </td>
                    <td class="center edit">
                        <a href="#" class="glyphicon glyphicon-edit" title="edit"></a>
                        {% if not track.public %}
                            <a href="#" class="glyphicon glyphicon-trash" title="delete"></a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="alert alert-info" role="alert">
        <form class="form" method="post" enctype="multipart/form-data" action="{% url 'table:view' %}">
            {% csrf_token %}
            You don't have Tracks yet. Try to
            <label>
                <input type="file" accept=".gpx" onchange="$('div.progress').show(); this.form.submit()" hidden name="gpx_file">
                <a  class="alert-link">import your first Track</a>
            </label>
        </form>
    </div>
{% endif %}