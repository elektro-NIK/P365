{% extends "base/base.html" %}
{% load leaflet_tags %}
{% load staticfiles %}

{% block content %}
    <div class="row map">
        <div class="progress progress-bar-thin">
            <div class="progress-bar progress-bar-striped active" role="progressbar"></div>
        </div>
        {% csrf_token %}
        {% leaflet_map "mainmap" callback="window.map_init_basic" %}
    </div>
{% endblock %}

{% block css %}
    {% leaflet_css %}
    <link href="{% static 'css/map.css' %}" rel="stylesheet" media="screen">
{% endblock %}

{% block js %}
    {% leaflet_js %}
    <script src="{% static 'js/msg_wrong.js' %}"></script>
    <script src="{% static 'js/map.js' %}"></script>
    <script>
        var bounds;
        var progress;

        function map_init_basic (map, options) {
            map.on('click', function() {
                bounds && bounds.isValid() ? map.fitBounds(bounds) : {};
            });
            progress = -1;
            get_all(map, "{% url 'track:json_ids' %}", "{% url 'track:json' id=0 %}",
                         "{% url 'track:view' id=0 %}", null, "{% url 'track:json_delete' id=0 %}");
            get_all(map, "{% url 'route:json_ids' %}", "{% url 'route:json' id=0 %}",
                         "{% url 'route:view' id=0 %}", "{% url 'route:edit' id=0 %}", "{% url 'route:json_delete' id=0 %}");
            get_all(map, "{% url 'poi:json_ids' %}", "{% url 'poi:json' id=0 %}",
                         "{% url 'poi:view' id=0 %}", "{% url 'poi:edit' id=0 %}", "{% url 'poi:json_delete' id=0 %}");
        }
    </script>
{% endblock %}
