{% extends "base/base.html" %}
{% load leaflet_tags %}
{% load staticfiles %}

{% block content %}
    <div class="row map">
        <div class="progress progress-bar-thin">
            <div class="progress-bar progress-bar-striped active" role="progressbar"></div>
        </div>
        {% leaflet_map "mainmap" callback="window.map_init_basic" %}
    </div>
{% endblock %}

{% block css %}
    {% leaflet_css %}
    <link href="{% static 'css/map.css' %}" rel="stylesheet" media="screen">
{% endblock %}

{% block js %}
    {% leaflet_js %}
    <script src="{% static 'js/msg_wrong.js' %}"></script>
    <script src="{% static 'js/map.js' %}"></script>
    <script>
        var bounds;
        var progress;

        function map_init_basic (map, options) {
            map.on('click', function() {
                bounds && bounds.isValid() ? map.fitBounds(bounds) : {};
            });
            progress = 0;
            get_all(map, "{% url 'json_track_ids' %}", "{% url 'json_track' id=0 %}", "{% url 'track' id=0 %}");
            get_all(map, "{% url 'json_route_ids' %}", "{% url 'json_route' id=0 %}",
                         "{% url 'route' id=0 %}", "{% url 'route_edit' id=0 %}");
            get_all(map, "{% url 'json_poi_ids' %}", "{% url 'json_poi' id=0 %}",
                         "{% url 'poi' id=0 %}", "{% url 'poi_edit' id=0 %}");
        }
    </script>
{% endblock %}
